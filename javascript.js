var kalevala = [ 'Mieleni minun tekevi, aivoni ajattelevi lÃ¤hteÃ¤ni laulamahan, saa\'ani sanelemahan, sukuvirttÃ¤ suoltamahan, lajivirttÃ¤ laulamahan. Sanat suussani sulavat, puhe\'et putoelevat, kielelleni kerkiÃ¤vÃ¤t, hampahilleni hajoovat.',
    'Veli kulta, veikkoseni, kaunis kasvinkumppalini! LÃ¤he nyt kanssa laulamahan, saa kera sanelemahan yhtehen yhyttyÃ¤mme, kahta\'alta kÃ¤ytyÃ¤mme! Harvoin yhtehen yhymme, saamme toinen toisihimme nÃ¤illÃ¤ raukoilla rajoilla, poloisilla Pohjan mailla.',
    'LyÃ¶kÃ¤mme kÃ¤si kÃ¤tehen, sormet sormien lomahan, lauloaksemme hyviÃ¤, parahia pannaksemme, kuulla noien kultaisien, tietÃ¤ mielitehtoisien, nuorisossa nousevassa, kansassa kasuavassa: noita saamia sanoja, virsiÃ¤ virittÃ¤miÃ¤',
    'vyÃ¶ltÃ¤ vanhan VÃ¤inÃ¤mÃ¶isen, alta ahjon Ilmarisen, pÃ¤Ã¤stÃ¤ kalvan Kaukomielen, Joukahaisen jousen tiestÃ¤, Pohjan peltojen periltÃ¤, Kalevalan kankahilta. Niit\' ennen isoni lauloi kirvesvartta vuollessansa; niitÃ¤ Ã¤itini opetti vÃ¤Ã¤tessÃ¤nsÃ¤ vÃ¤rttinÃ¤tÃ¤,',
    'minun lasna lattialla eessÃ¤ polven pyÃ¶riessÃ¤, maitopartana pahaisna, piimÃ¤suuna pikkaraisna. Sampo ei puuttunut sanoja eikÃ¤ Louhi luottehia: vanheni sanoihin sampo, katoi Louhi luottehisin, virsihin Vipunen kuoli, LemminkÃ¤inen leikkilÃ¶ihin.',
    'Viel\' on muitaki sanoja, ongelmoita oppimia: tieohesta tempomia, kanervoista katkomia, risukoista riipomia, vesoista vetelemiÃ¤, pÃ¤Ã¤stÃ¤ heinÃ¤n hieromia, raitiolta ratkomia, paimenessa kÃ¤yessÃ¤ni, lasna karjanlaitumilla,',
    'metisillÃ¤ mÃ¤ttÃ¤hillÃ¤, kultaisilla kunnahilla, mustan Muurikin jÃ¤lessÃ¤, Kimmon kirjavan keralla. Vilu mulle virttÃ¤ virkkoi, sae saatteli runoja. VirttÃ¤ toista tuulet toivat, meren aaltoset ajoivat. Linnut liitteli sanoja, puien latvat lausehia.',
    'Ne minÃ¤ kerÃ¤lle kÃ¤Ã¤rin, sovittelin sommelolle. KerÃ¤n pistin kelkkahani, sommelon rekoseheni; ve\'in kelkalla kotihin, rekosella riihen luoksi; panin aitan parven pÃ¤Ã¤hÃ¤n vaskisehen vakkasehen. Viikon on virteni vilussa, kauan kaihossa sijaisnut.',
    'VeÃ¤nkÃ¶ vilusta virret, lapan laulut pakkasesta, tuon tupahan vakkaseni, rasian rahin nenÃ¤hÃ¤n, alle kuulun kurkihirren, alle kaunihin katoksen, aukaisen sanaisen arkun, virsilippahan viritÃ¤n, kerittelen pÃ¤Ã¤n kerÃ¤ltÃ¤, suorin solmun sommelolta?',
    'Niin laulan hyvÃ¤nki virren, kaunihinki kalkuttelen ruoalta rukihiselta, oluelta ohraiselta. Kun ei tuotane olutta, tarittane taarivettÃ¤, laulan suulta laihemmalta, vetoselta vierettelen tÃ¤mÃ¤n iltamme iloksi, pÃ¤ivÃ¤n kuulun kunniaksi,',
    'vaiko huomenen huviksi, uuen aamun alkeheksi. Noin kuulin saneltavaksi, tiesin virttÃ¤ tehtÃ¤vÃ¤ksi: yksin meillÃ¤ yÃ¶t tulevat, yksin pÃ¤ivÃ¤t valkeavat; yksin syntyi VÃ¤inÃ¤mÃ¶inen, ilmestyi ikirunoja kapehesta kantajasta, Ilmattaresta emosta.',
    'Olipa impi, ilman tyttÃ¶, kave luonnotar korea. Piti viikoista pyhyyttÃ¤, iÃ¤n kaiken impeyttÃ¤ ilman pitkillÃ¤ pihoilla, tasaisilla tanterilla. IkÃ¤vystyi aikojansa, ouostui elÃ¤mÃ¤tÃ¤nsÃ¤, aina yksin ollessansa, impenÃ¤ elÃ¤essÃ¤nsÃ¤',
    'ilman pitkillÃ¤ pihoilla, avaroilla autioilla. Jop\' on astuiksen alemma, laskeusi lainehille, meren selvÃ¤lle selÃ¤lle, ulapalle aukealle. Tuli suuri tuulen puuska, iÃ¤stÃ¤ vihainen ilma; meren kuohuille kohotti, lainehille laikahutti.',
    'Tuuli neittÃ¤ tuuitteli, aalto impeÃ¤ ajeli ympÃ¤ri selÃ¤n sinisen, lakkipÃ¤ien lainehien: tuuli tuuli kohtuiseksi, meri paksuksi panevi. Kantoi kohtua kovoa, vatsantÃ¤yttÃ¤ vaikeata vuotta seitsemÃ¤n satoa, yheksÃ¤n yrÃ¶n ikeÃ¤;',
    'eikÃ¤ synny syntyminen, luovu luomatoin sikiÃ¶. Vieri impi veen emona. Uipi iÃ¤t, uipi lÃ¤nnet, uipi luotehet, etelÃ¤t, uipi kaikki ilman rannat tuskissa tulisen synnyn, vatsanvaivoissa kovissa; eikÃ¤ synny syntyminen, luovu luomatoin sikiÃ¶.',
    'ItkeÃ¤ hyryttelevi; sanan virkkoi, noin nimesi: "Voi poloinen, pÃ¤iviÃ¤ni, lapsi kurja, kulkuani! Jo olen joutunut johonki: iÃ¤kseni ilman alle, tuulen tuuiteltavaksi, aaltojen ajeltavaksi nÃ¤illÃ¤ vÃ¤ljillÃ¤ vesillÃ¤, lake\'illa lainehilla!',
    '"Parempi olisi ollut ilman impenÃ¤ eleÃ¤, kuin on nyt tÃ¤tÃ¤ nykyÃ¤ vierÃ¤hellÃ¤ veen emona: vilu tÃ¤Ã¤ll\' on ollakseni, vaiva vÃ¤rjÃ¤tellÃ¤kseni, aalloissa asuakseni, veessÃ¤ vieriellÃ¤kseni. "Oi Ukko, ylijumala, ilman kaiken kannattaja!',
    'Tule tÃ¤nne tarvittaissa, kÃ¤y tÃ¤nne kutsuttaessa! PÃ¤Ã¤stÃ¤ piika pintehestÃ¤, vaimo vatsanvÃ¤Ã¤ntehestÃ¤! KÃ¤y pian, vÃ¤lehen jou\'u, vÃ¤lehemmin tarvitahan!" Kului aikoa vÃ¤hÃ¤isen, pirahteli pikkaraisen. Tuli sotka, suora lintu; lenteÃ¤ lekuttelevi',
    'etsien pesÃ¤n sijoa, asuinmaata arvaellen. Lenti iÃ¤t, lenti lÃ¤nnet, lenti luotehet, etelÃ¤t. Ei lÃ¶yÃ¤ tiloa tuota, paikkoa pahintakana, kuhun laatisi pesÃ¤nsÃ¤, ottaisi olosijansa. Liitelevi, laatelevi; arvelee, ajattelevi:',
    '"TeenkÃ¶ tuulehen tupani, aalloillen asuinsijani? Tuuli kaatavi tupasen, aalto vie asuinsijani." Niin silloin ve\'en emonen, veen emonen, ilman impi, nosti polvea merestÃ¤, lapaluuta lainehesta sotkalle pesÃ¤n sijaksi, asuinmaaksi armahaksi.',
    'Tuo sotka, sorea lintu, liiteleikse, laateleikse. Keksi polven veen emosen sinervÃ¤isellÃ¤ selÃ¤llÃ¤; luuli heinÃ¤mÃ¤ttÃ¤hÃ¤ksi, tuoreheksi turpeheksi. Lentelevi, liitelevi, pÃ¤Ã¤hÃ¤n polven laskeuvi. Siihen laativi pesÃ¤nsÃ¤, muni kultaiset munansa:',
    'kuusi kultaista munoa, rautamunan seitsemÃ¤nnen. Alkoi hautoa munia, pÃ¤Ã¤tÃ¤ polven lÃ¤mmitellÃ¤. Hautoi pÃ¤ivÃ¤n, hautoi toisen, hautoi kohta kolmannenki. Jopa tuosta veen emonen, veen emonen, ilman impi, tuntevi tulistuvaksi, hipiÃ¤nsÃ¤ hiiltyvÃ¤ksi;',
    'luuli polvensa palavan, kaikki suonensa sulavan. Vavahutti polveansa, jÃ¤rkytti jÃ¤seniÃ¤nsÃ¤: munat vierÃ¤hti vetehen, meren aaltohon ajaikse; karskahti munat muruiksi, katkieli kappaleiksi. Ei munat mutahan joua, siepalehet veen sekahan.',
    'Muuttuivat murut hyviksi, kappalehet kaunoisiksi: munasen alainen puoli alaiseksi maaemÃ¤ksi, munasen ylÃ¤inen puoli ylÃ¤iseksi taivahaksi; ylÃ¤puoli ruskeaista pÃ¤ivÃ¶seksi paistamahan, ylÃ¤puoli valkeaista, se kuuksi kumottamahan;',
    'mi munassa kirjavaista, ne tÃ¤hiksi taivahalle, mi munassa mustukaista, nepÃ¤ ilman pilvilÃ¶iksi. Ajat eellehen menevÃ¤t, vuoet tuota tuonnemmaksi uuen pÃ¤ivÃ¤n paistaessa, uuen kuun kumottaessa. Aina uipi veen emonen, veen emonen, ilman impi,',
    'noilla vienoilla vesillÃ¤, utuisilla lainehilla, eessÃ¤nsÃ¤ vesi vetelÃ¤, takanansa taivas selvÃ¤. Jo vuonna yheksÃ¤ntenÃ¤, kymmenentenÃ¤ kesÃ¤nÃ¤ nosti pÃ¤Ã¤tÃ¤nsÃ¤ merestÃ¤, kohottavi kokkoansa. Alkoi luoa luomiansa, saautella saamiansa',
    'selvÃ¤llÃ¤ meren selÃ¤llÃ¤, ulapalla aukealla. Kussa kÃ¤ttÃ¤ kÃ¤Ã¤nnÃ¤hytti, siihen niemet siivoeli; kussa pohjasi jalalla, kalahauat kaivaeli; kussa ilman kuplistihe, siihen syÃ¶verit syventi. Kylin maahan kÃ¤Ã¤ntelihe: siihen sai sileÃ¤t rannat;',
    'jaloin maahan kÃ¤Ã¤ntelihe: siihen loi lohiapajat; pÃ¤\'in pÃ¤Ã¤tyi maata vasten: siihen laitteli lahelmat. Ui siitÃ¤ ulomma maasta, seisattelihe selÃ¤lle: luopi luotoja merehen, kasvatti salakaria laivan laskemasijaksi, merimiesten pÃ¤Ã¤n menoksi.',
    'Jo oli saaret siivottuna, luotu luotoset merehen, ilman pielet pistettynÃ¤, maat ja manteret sanottu, kirjattu kivihin kirjat, veetty viivat kallioihin. Viel\' ei synny VÃ¤inÃ¤mÃ¶inen, ilmau ikirunoja. Vaka vanha VÃ¤inÃ¤mÃ¶inen kulki Ã¤itinsÃ¤ kohussa',
    'kolmekymmentÃ¤ keseÃ¤, yhen verran talviaki, noilla vienoilla vesillÃ¤, utuisilla lainehilla. Arvelee, ajattelevi, miten olla, kuin eleÃ¤ pimeÃ¤ssÃ¤ piilossansa, asunnossa ahtahassa, kuss\' ei konsa kuuta nÃ¤hnyt eikÃ¤ pÃ¤iveÃ¤ havainnut.',
    'Sanovi sanalla tuolla, lausui tuolla lausehella: "Kuu, keritÃ¤, pÃ¤ivyt, pÃ¤Ã¤stÃ¤, otava, yhÃ¤ opeta miestÃ¤ ouoilta ovilta, verÃ¤jiltÃ¤ vierahilta, nÃ¤iltÃ¤ pieniltÃ¤ pesiltÃ¤, asunnoilta ahtahilta! Saata maalle matkamiestÃ¤, ilmoillen inehmon lasta,',
    'kuuta taivon katsomahan, pÃ¤iveÃ¤ ihoamahan, otavaista oppimahan, tÃ¤htiÃ¤ tÃ¤hyÃ¤mÃ¤hÃ¤n!" Kun ei kuu kerittÃ¤nynnÃ¤ eikÃ¤ pÃ¤ivyt pÃ¤Ã¤stÃ¤nynnÃ¤, ouosteli aikojansa, tuskastui elÃ¤mÃ¤tÃ¤nsÃ¤: liikahutti linnan portin sormella nimettÃ¶mÃ¤llÃ¤,',
    'lukon luisen luikahutti vasemmalla varpahalla; tuli kynsin kynnykseltÃ¤, polvin porstuan ovelta. SiitÃ¤ suistui suin merehen, kÃ¤sin kÃ¤Ã¤ntyi lainehesen; jÃ¤Ã¤pi mies meren varahan, uros aaltojen sekahan. Virui siellÃ¤ viisi vuotta, sekÃ¤ viisi jotta kuusi,',
    'vuotta seitsemÃ¤n, kaheksan. Seisottui selÃ¤lle viimein, niemelle nimettÃ¶mÃ¤lle, manterelle puuttomalle. Polvin maasta ponnistihe, kÃ¤sivarsin kÃ¤Ã¤nnÃ¤ltihe. Nousi kuuta katsomahan, pÃ¤iveÃ¤ ihoamahan, otavaista oppimahan, tÃ¤htiÃ¤ tÃ¤hyÃ¤mÃ¤hÃ¤n.',
    'Se oli synty VÃ¤inÃ¤mÃ¶isen, rotu rohkean runojan kapehesta kantajasta, Ilmattaresta emosta.',
]

var lineSlider = document.getElementById("line-range");
var lineCount = document.getElementById("line-count");
lineCount.innerHTML = lineSlider.value * 10; // Display the default Line Slider value

// Update the current Line Slider value (each time you drag the Line Slider handle)
lineSlider.oninput = function() {
    lineCount.innerHTML = this.value * 10;
}

function newKalevala() {
    var startLine = [];
    var startLine = Math.floor(Math.random() * (kalevala.length) );
    var endLine = [];
    // If the sum of the start line + number of lines to generate is less
    // than the total number of lines... Set the end line as the final line,
    // And set the start line number as the end line minus the number of lines
    // to be generated, so that the slider always represents how many lines
    // are generated.
    if ( ( startLine + parseInt(lineSlider.value)) >= kalevala.length - 1 ) {
        var startLine = (kalevala.length - 1) - parseInt(lineSlider.value);
        var endLine = kalevala.length - 1;
    } else {
        var endLine = startLine + parseInt(lineSlider.value) - 1;
    }

    // console.log('Start line: ' + startLine);
    // console.log('End line: ' + endLine);

    // Get the array of line numbers to get, from start line to end line
    var kalevalaRange = [];
    for (var i = startLine; i <= endLine; i++) {
        kalevalaRange.push(i);
    }

    if (kalevalaRange.length > 0) {

        var generatedKalevala = [];
        for (const [i, line] of kalevalaRange.entries()) {

            // Capitalise the first character of the line.
            kalevalaLineCapitalised = kalevala[line].charAt(0).toUpperCase() + kalevala[line].slice(1);

            // Replace the last comma or semicolon of each line with a full stop.
            // Add a full stop to the end of each line if it still doesn't have one.
            kalevalaLine = kalevalaLineCapitalised.replace(/[,;:]\s*$/, "").replace(/([^.])$/, '$1.');

            // If selected, start the generated text with 'Mieleni minun tekevi,',
            // Unless it is the first line, which always starts with 'Mieleni minun tekevi,'.
            if (document.getElementById('mieleni').checked && i == 0 && startLine != 0) {
                kalevalaLine = 'Mieleni minun tekevi, ' + kalevalaLine.charAt(0).toLowerCase() + kalevala[line].slice(1);
            }

            // Add breaks after every 2nd line of array
            // (= 20 lines of Kalevala per paragraph).
            if( i % 2 == 0 ){
                kalevalaLine = '<p>' + kalevalaLine.split("\n").join('</p><p>');
            }

            generatedKalevala += " " + kalevalaLine;
        }

    }

    // Insert generated Kalevala excerpt
    var kalevalaFinal = document.getElementById("kalevala");
    kalevalaFinal.innerHTML = generatedKalevala;

    // Reveal the container if it was previously hidden
    var kalevalaContainer = document.getElementById("kalevala--container");
    if (kalevalaContainer.classList.contains('transparent', 'collapsed')) {
        kalevalaContainer.classList.remove('transparent', 'collapsed');
    }

    // Set up the line range as a nice string.
    var lineSpan = document.getElementById('line-span');
    // Calculate the start line
    var startLineCalculated = (startLine * 10) + 1;
    // Calculate the end line
    if (endLine === 34) {
        // If the end line is the very last line,
        // set it to 344 as this is the final line
        // of the poem in this JS.
        var endLineCalculated = 344;
    } else {
        var endLineCalculated = (endLine + 1) * 10;
    }
    lineSpan.innerHTML = '<p>Generated lines ' + startLineCalculated + ' to ' + endLineCalculated + ' of Kalevala.</p>';

    // Reveal the copy text button
    var copyButton = document.getElementById("copy-button");
    if (copyButton.classList.contains('transparent')) {
        copyButton.classList.remove('transparent');
    }

    // Reveal the last Celtic knot pattern button
    var copyButton = document.getElementById("celtic-knot--last");
    if (copyButton.classList.contains('transparent', 'collapsed')) {
        copyButton.classList.remove('transparent', 'collapsed');
    }
}

// Initialise Copy Text button
function copyToClipboard(id) {
    var from = document.getElementById(id);
    var range = document.createRange();
    window.getSelection().removeAllRanges();
    range.selectNode(from);
    window.getSelection().addRange(range);
    document.execCommand('copy');
    window.getSelection().removeAllRanges();

    var tooltip = document.getElementById("tooltip__text");
    tooltip.classList.remove('transparent');
    tooltip.innerHTML = "Copied! ðŸ‡«ðŸ‡®";
    setTimeout(function(){
        tooltip.classList.add("transparent");
    }, 1500);
}